import requests
from termcolor import colored
import sys
import time

def export_results(keyword, exploits):
    filename = f"exploit_{keyword.replace(' ', '_')}.txt"
    with open(filename, 'w', encoding='utf-8') as f:
        for e in exploits:
            f.write(f"{e}\n")
    print(colored(f"Results saved to {filename}", "cyan"))

def main():
    print(colored("[Exploit Search] Enter a keyword (e.g. apache, wordpress):", "cyan"))
    keyword = input(colored("Keyword > ", "red")).strip()
    print(colored(f"Searching Exploit-DB for '{keyword}'...", "yellow"))
    try:
        url = f"https://www.exploit-db.com/search?order_by=date_published&order=desc&filter_page=1&filter_description={keyword}"
        resp = requests.get(url, timeout=15)
        exploits = []
        # Simple scraping for exploit titles/links (API is not public)
        for line in resp.text.split('\n'):
            if 'href="/exploits/' in line and 'data-description' in line:
                title = line.split('data-description="')[1].split('"')[0]
                eid = line.split('href="/exploits/')[1].split('"')[0]
                exploits.append(f"{title} (https://www.exploit-db.com/exploits/{eid})")
        if exploits:
            print(colored(f"\n[Exploit-DB Results] Showing up to 10 results:", "green", attrs=["bold"]))
            for e in exploits[:10]:
                print(colored(f"- {e}", "yellow"))
            save = input(colored("Export results to file? (y/n): ", "cyan")).strip().lower()
            if save == 'y':
                export_results(keyword, exploits[:10])
        else:
            print(colored("No exploits found or site layout changed.", "magenta"))
    except Exception as e:
        print(colored(f"Failed to search Exploit-DB: {e}", "red"))

if __name__ == "__main__":
    main() 